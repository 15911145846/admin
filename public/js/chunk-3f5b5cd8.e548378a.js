(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3f5b5cd8"],{"2af7":function(t,e,o){"use strict";function a(t,e,o,a){return new(o||(o=Promise))((function(n,r){function i(t){try{s(a.next(t))}catch(t){r(t)}}function l(t){try{s(a.throw(t))}catch(t){r(t)}}function s(t){t.done?n(t.value):new o((function(e){e(t.value)})).then(i,l)}s((a=a.apply(t,e||[])).next())}))}function n(t,e){var o,a,n,r,i={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return r={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function l(r){return function(l){return function(r){if(o)throw new TypeError("Generator is already executing.");for(;i;)try{if(o=1,a&&(n=2&r[0]?a.return:r[0]?a.throw||((n=a.return)&&n.call(a),0):a.next)&&!(n=n.call(a,r[1])).done)return n;switch(a=0,n&&(r=[2&r[0],n.value]),r[0]){case 0:case 1:n=r;break;case 4:return i.label++,{value:r[1],done:!1};case 5:i.label++,a=r[1],r=[0];continue;case 7:r=i.ops.pop(),i.trys.pop();continue;default:if(!(n=(n=i.trys).length>0&&n[n.length-1])&&(6===r[0]||2===r[0])){i=0;continue}if(3===r[0]&&(!n||r[1]>n[0]&&r[1]<n[3])){i.label=r[1];break}if(6===r[0]&&i.label<n[1]){i.label=n[1],n=r;break}if(n&&i.label<n[2]){i.label=n[2],i.ops.push(r);break}n[2]&&i.ops.pop(),i.trys.pop();continue}r=e.call(t,i)}catch(t){r=[6,t],a=0}finally{o=n=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,l])}}}o.d(e,"a",(function(){return m}));var r=["text/plain","text/html"],i=function(){(console.warn||console.log).call(arguments)}.bind(console,"[clipboard-polyfill]"),l=!0,s=function(){function t(){this.m={}}return t.prototype.setData=function(t,e){l&&-1===r.indexOf(t)&&i("Unknown data type: "+t,"Call clipboard.suppressWarnings() to suppress this warning."),this.m[t]=e},t.prototype.getData=function(t){return this.m[t]},t.prototype.forEach=function(t){for(var e in this.m)t(this.m[e],e)},t}(),c=function(t){},d=!0,u=function(){(console.warn||console.log).apply(console,arguments)}.bind("[clipboard-polyfill]"),f="text/plain";function p(t){return a(this,void 0,void 0,(function(){var e;return n(this,(function(o){if(d&&!t.getData(f)&&u("clipboard.write() was called without a `text/plain` data type. On some platforms, this may result in an empty clipboard. Call clipboard.suppressWarnings() to suppress this warning."),x()){if(function(t){var e=t.getData(f);if(void 0!==e)return window.clipboardData.setData("Text",e);throw new Error("No `text/plain` value was specified.")}(t))return[2];throw new Error("Copying failed, possibly because the user rejected it.")}if(g(t))return c("regular execCopy worked"),[2];if(navigator.userAgent.indexOf("Edge")>-1)return c('UA "Edge" => assuming success'),[2];if(b(document.body,t))return c("copyUsingTempSelection worked"),[2];if(function(t){var e=document.createElement("div");e.setAttribute("style","-webkit-user-select: text !important"),e.textContent="temporary element",document.body.appendChild(e);var o=b(e,t);return document.body.removeChild(e),o}(t))return c("copyUsingTempElem worked"),[2];if(void 0!==(e=t.getData(f))&&function(t){c("copyTextUsingDOM");var e=document.createElement("div");e.setAttribute("style","-webkit-user-select: text !important");var o=e;e.attachShadow&&(c("Using shadow DOM."),o=e.attachShadow({mode:"open"}));var a=document.createElement("span");a.innerText=t,o.appendChild(a),document.body.appendChild(e),v(a);var n=document.execCommand("copy");return y(),document.body.removeChild(e),n}(e))return c("copyTextUsingDOM worked"),[2];throw new Error("Copy command failed.")}))}))}function m(t){return a(this,void 0,void 0,(function(){return n(this,(function(e){return navigator.clipboard&&navigator.clipboard.writeText?(c("Using `navigator.clipboard.writeText()`."),[2,navigator.clipboard.writeText(t)]):[2,p(w(t))]}))}))}var h=function(){this.success=!1};function g(t){var e=new h,o=function(t,e,o){c("listener called"),t.success=!0,e.forEach((function(e,a){var n=o.clipboardData;n.setData(a,e),a===f&&n.getData(a)!==e&&(c("setting text/plain failed"),t.success=!1)})),o.preventDefault()}.bind(this,e,t);document.addEventListener("copy",o);try{document.execCommand("copy")}finally{document.removeEventListener("copy",o)}return e.success}function b(t,e){v(t);var o=g(e);return y(),o}function v(t){var e=document.getSelection();if(e){var o=document.createRange();o.selectNodeContents(t),e.removeAllRanges(),e.addRange(o)}}function y(){var t=document.getSelection();t&&t.removeAllRanges()}function w(t){var e=new s;return e.setData(f,t),e}function x(){return"undefined"==typeof ClipboardEvent&&void 0!==window.clipboardData&&void 0!==window.clipboardData.setData}},"63d5":function(t,e,o){"use strict";var a=o("ec4e"),n=o.n(a);n.a},"85ae":function(t,e,o){"use strict";o.r(e);var a=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"cs-p"},[o("el-form",{attrs:{inline:!0,size:"small"}},[t.auth.add?o("el-form-item",[o("el-button",{attrs:{icon:"el-icon-plus",disabled:t.loading},on:{click:t.handleCreate}},[t._v("新增二维码")])],1):t._e(),t.auth.del?o("el-form-item",[o("el-button",{attrs:{icon:"el-icon-delete",disabled:t.loading},on:{click:function(e){return t.handleDelete(null)}}},[t._v("删除")])],1):t._e(),o("cs-help",{staticStyle:{"padding-bottom":"19px"},attrs:{router:t.$route.path}})],1),o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{data:t.currentTableData,"highlight-current-row":!0},on:{"selection-change":t.handleSelectionChange,"sort-change":t.sortChange}},[o("el-table-column",{attrs:{type:"selection",width:"30"}}),o("el-table-column",{attrs:{label:"名称",prop:"name","min-width":"180"}}),o("el-table-column",{attrs:{label:"内容",prop:"text","min-width":"220","show-overflow-tooltip":!0}}),o("el-table-column",{attrs:{label:"Logo",prop:"logo",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.logo?o("el-popover",{attrs:{width:"150",placement:"top",trigger:"hover"}},[o("div",{staticClass:"popover-image"},[o("el-image",{attrs:{src:e.row.logo,fit:"fill"},nativeOn:{click:function(o){return t.$preview(e.row.logo)}}})],1),o("i",{staticClass:"el-icon-picture",attrs:{slot:"reference"},slot:"reference"})]):t._e()]}}])}),o("el-table-column",{attrs:{label:"尺寸",prop:"size",sortable:"custom",width:"75"}}),o("el-table-column",{attrs:{label:"操作",align:"center","min-width":"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[t.auth.view?o("el-button",{attrs:{size:"small",type:"text"},on:{click:function(o){return t.handleView(e.$index)}}},[t._v("详细")]):t._e(),t.auth.set?o("el-button",{attrs:{size:"small",type:"text"},on:{click:function(o){return t.handleUpdate(e.$index)}}},[t._v("编辑")]):t._e(),t.auth.del?o("el-button",{attrs:{size:"small",type:"text"},on:{click:function(o){return t.handleDelete(e.$index)}}},[t._v("删除")]):t._e()]}}])})],1),o("el-dialog",{attrs:{title:t.textMap[t.dialogStatus],visible:t.dialogFormVisible,"append-to-body":!0,"close-on-click-modal":!1,width:"600px"},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[o("el-form",{ref:"form",attrs:{model:t.form,rules:t.rules,"label-width":"80px"}},[o("el-form-item",{attrs:{label:"名称",prop:"name"}},[o("el-input",{attrs:{placeholder:"请输入二维码名称",clearable:!0},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),o("el-form-item",{attrs:{label:"内容",prop:"text"}},[o("el-input",{attrs:{placeholder:"请输入二维码内容",type:"textarea",rows:3},model:{value:t.form.text,callback:function(e){t.$set(t.form,"text",e)},expression:"form.text"}})],1),o("el-form-item",{attrs:{label:"Logo",prop:"logo"}},[o("el-input",{attrs:{placeholder:"可输入二维码Logo链接",clearable:!0},model:{value:t.form.logo,callback:function(e){t.$set(t.form,"logo",e)},expression:"form.logo"}},[o("el-dropdown",{attrs:{slot:"append","show-timeout":50},on:{command:t.handleCommand},slot:"append"},[o("el-button",{attrs:{icon:"el-icon-upload"}}),o("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[o("el-dropdown-item",{attrs:{command:"storage",icon:"el-icon-finished"}},[t._v("资源选择")]),o("el-dropdown-item",{attrs:{command:"upload",icon:"el-icon-upload2"}},[t._v("上传资源")])],1)],1)],1)],1),o("el-form-item",{attrs:{label:"尺寸",prop:"size"}},[o("el-input-number",{staticStyle:{width:"120px"},attrs:{"controls-position":"right",min:1,max:10},model:{value:t.form.size,callback:function(e){t.$set(t.form,"size",e)},expression:"form.size"}})],1)],1),o("el-divider",[t._v("效果预览")]),t.form.text?o("div",{staticClass:"cs-tc"},[t.qrcodeImage?o("el-image",{attrs:{fit:"fill",src:t.qrcodeImage}}):t._e()],1):t._e(),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{size:"small"},on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取消")]),"create"===t.dialogStatus?o("el-button",{attrs:{type:"primary",loading:t.dialogLoading,size:"small"},on:{click:t.create}},[t._v("确定")]):o("el-button",{attrs:{type:"primary",loading:t.dialogLoading,size:"small"},on:{click:t.update}},[t._v("修改")])],1),o("cs-storage",{ref:"storage",staticStyle:{display:"none"},attrs:{limit:1},on:{confirm:t._getStorageFileList}}),o("cs-upload",{ref:"upload",staticStyle:{display:"none"},attrs:{type:"slot",accept:"image/*",limit:1,multiple:!1},on:{confirm:t._getUploadFileList}})],1),o("el-dialog",{attrs:{title:"二维码预览",visible:t.dialogQrcodeVisible,"append-to-body":!0,"close-on-click-modal":!1,width:"600px"},on:{"update:visible":function(e){t.dialogQrcodeVisible=e}}},[o("el-row",{attrs:{gutter:20}},[o("el-col",{attrs:{span:4}},[o("p",[t._v("效果预览")])]),o("el-col",{attrs:{span:20}},[t.qrcodeData.url?o("el-image",{attrs:{fit:"fill",src:t.qrcodeData.url}}):t._e()],1)],1),o("el-row",{attrs:{gutter:20}},[o("el-col",{attrs:{span:4}},[o("p",[t._v("名称")])]),o("el-col",{attrs:{span:20}},[o("p",[t._v(t._s(t.qrcodeData.name))])])],1),o("el-row",{attrs:{gutter:20}},[o("el-col",{attrs:{span:4}},[o("p",[t._v("实际内容")])]),o("el-col",{attrs:{span:20}},[o("p",[t._v(t._s(t.qrcodeData.text))])])],1),o("el-row",{attrs:{gutter:20}},[o("el-col",{attrs:{span:4}},[o("p",[t._v("调用地址")])]),o("el-col",{attrs:{span:20}},[o("p",[t._v(t._s(t.qrcodeData.url))])])],1),o("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{attrs:{size:"small"},on:{click:t.handleCopy}},[t._v("复制调用地址")]),o("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(e){t.dialogQrcodeVisible=!1}}},[t._v("确定")])],1)],1)],1)},n=[],r=(o("a4d3"),o("e01a"),o("d28b"),o("99af"),o("4de4"),o("c975"),o("a434"),o("b0c0"),o("e439"),o("dbb4"),o("b64b"),o("d3b7"),o("3ca3"),o("159b"),o("ddb0"),o("ade3")),i=o("f749"),l=o("60bb"),s=o("2af7");function c(t,e){var o=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),o.push.apply(o,a)}return o}function d(t){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?c(Object(o),!0).forEach((function(e){Object(r["a"])(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):c(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}var u={components:{csUpload:function(){return o.e("chunk-590f2ff2").then(o.bind(null,"8422"))},csStorage:function(){return o.e("chunk-1358f166").then(o.bind(null,"8704"))}},props:{loading:{default:!1},tableData:{default:function(){return[]}}},data:function(){return{qrcodeUrl:"",qrcodeImage:"",currentTableData:[],multipleSelection:[],auth:{add:!1,set:!1,del:!1,view:!1},dialogLoading:!1,dialogFormVisible:!1,dialogStatus:"",dialogQrcodeVisible:!1,qrcodeData:{name:"",text:"",url:""},textMap:{update:"编辑二维码",create:"新增二维码"},form:{name:void 0,text:void 0,size:void 0,logo:void 0},rules:{name:[{required:!0,message:"名称不能为空",trigger:"blur"},{max:50,message:"长度不能大于 50 个字符",trigger:"blur"}],text:[{required:!0,message:"内容不能为空",trigger:"blur"},{max:255,message:"内容不能大于 255 个字符",trigger:"blur"}],logo:[{max:512,message:"长度不能大于 512 个字符",trigger:"blur"}],size:[{type:"number",message:"必须为数字值",trigger:"blur"}]}}},computed:{changeQrcode:function(){var t=this.form,e=t.text,o=t.size,a=t.logo;return{text:e,size:o,logo:a}}},watch:{tableData:{handler:function(t){this.currentTableData=t},immediate:!0},changeQrcode:{handler:function(){var t=this;this.$nextTick((function(){t._getQrcodeImage()}))}},dialogQrcodeVisible:{handler:function(t){!1===t&&(this.qrcodeData.url="")}}},mounted:function(){var t=this;this._validationAuth(),Object(i["c"])().then((function(e){t.qrcodeUrl=e.data["call_url"]}))},methods:{_validationAuth:function(){this.auth.add=this.$has("/system/aided/qrcode/add"),this.auth.set=this.$has("/system/aided/qrcode/set"),this.auth.del=this.$has("/system/aided/qrcode/del"),this.auth.view=this.$has("/system/aided/qrcode/view")},_getIdList:function(t){null===t&&(t=this.multipleSelection);var e=[];return Array.isArray(t)?t.forEach((function(t){e.push(t.qrcode_id)})):e.push(this.currentTableData[t].qrcode_id),e},handleCommand:function(t){switch(t){case"storage":this.$refs.storage.handleStorageDlg([0,2]);break;case"upload":this.$refs.upload.handleUploadDlg();break}},_getQrcodeImage:Object(l["debounce"])((function(){if(this.form.text){var t="?text=".concat(this.form.text,"&size=").concat(this.form.size,"&logo=").concat(this.form.logo);this.qrcodeImage=this.qrcodeUrl+encodeURI(t)}}),500),_getUploadFileList:function(t){if(t.length){var e=t[0].response;e&&200===e.status&&0===e.data[0].type&&(this.form.logo=document.location.protocol+"//"+e.data[0].url)}},_getStorageFileList:function(t){if(t.length){var e=!0,o=!1,a=void 0;try{for(var n,r=t[Symbol.iterator]();!(e=(n=r.next()).done);e=!0){var i=n.value;if(0===i.type){this.form.logo=document.location.protocol+"//"+i.url;break}}}catch(l){o=!0,a=l}finally{try{e||null==r.return||r.return()}finally{if(o)throw a}}}},handleSelectionChange:function(t){this.multipleSelection=t},sortChange:function(t){var e=t.column,o=t.prop,a=t.order,n={order_type:void 0,order_field:void 0};e&&a&&(n.order_type="ascending"===a?"asc":"desc",n.order_field=o),this.$emit("sort",n)},handleCreate:function(){var t=this;this.qrcodeImage="",this.form={name:"",text:"",size:3,logo:""},this.$nextTick((function(){t.$refs.form.clearValidate()})),this.dialogStatus="create",this.dialogLoading=!1,this.dialogFormVisible=!0},create:function(){var t=this;this.$refs.form.validate((function(e){e&&(t.dialogLoading=!0,Object(i["a"])(d({},t.form)).then((function(e){t.currentTableData.unshift(e.data),t.dialogFormVisible=!1,t.$message.success("操作成功")})).catch((function(){t.dialogLoading=!1})))}))},handleDelete:function(t){var e=this,o=this._getIdList(t);0!==o.length?this.$confirm("确定要执行该操作吗?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",closeOnClickModal:!1}).then((function(){Object(i["b"])(o).then((function(){for(var t=e.currentTableData.length-1;t>=0;t--)-1!==o.indexOf(e.currentTableData[t].qrcode_id)&&e.currentTableData.splice(t,1);e.currentTableData.length<=0&&e.$emit("refresh",!0),e.$message.success("操作成功")}))})).catch((function(){})):this.$message.error("请选择要操作的数据")},handleUpdate:function(t){var e=this;this.qrcodeImage="",this.currentIndex=t,this.form=d({},this.currentTableData[t]),this.$nextTick((function(){e.$refs.form.clearValidate()})),this.dialogStatus="update",this.dialogLoading=!1,this.dialogFormVisible=!0},update:function(){var t=this;this.$refs.form.validate((function(e){e&&(t.dialogLoading=!0,Object(i["e"])(d({},t.form)).then((function(e){t.$set(t.currentTableData,t.currentIndex,d({},t.currentTableData[t.currentIndex],{},e.data)),t.dialogFormVisible=!1,t.$message.success("操作成功")})).catch((function(){t.dialogLoading=!1})))}))},handleView:function(t){var e=this.currentTableData[t];this.qrcodeData={name:e.name,text:e.text,url:this.qrcodeUrl+"?qrcode_id=".concat(e.qrcode_id)},this.dialogQrcodeVisible=!0},handleCopy:function(){var t=this;s["a"](this.qrcodeData.url).then((function(){t.$message.success("已复制调用地址到剪贴板")})).catch((function(e){t.$message.error(e)}))}}},f=u,p=(o("63d5"),o("2877")),m=Object(p["a"])(f,a,n,!1,null,"0fea0b12",null);e["default"]=m.exports},ec4e:function(t,e,o){}}]);