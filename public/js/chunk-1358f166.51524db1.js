(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1358f166","chunk-65796741"],{1213:function(t,e,r){"use strict";r.d(e,"a",(function(){return n})),r.d(e,"f",(function(){return o})),r.d(e,"n",(function(){return i})),r.d(e,"g",(function(){return s})),r.d(e,"e",(function(){return c})),r.d(e,"h",(function(){return l})),r.d(e,"l",(function(){return u})),r.d(e,"m",(function(){return d})),r.d(e,"b",(function(){return h})),r.d(e,"k",(function(){return g})),r.d(e,"j",(function(){return m})),r.d(e,"i",(function(){return p})),r.d(e,"d",(function(){return f})),r.d(e,"c",(function(){return b}));var a=r("b775");function n(t){return Object(a["a"])({url:"/v1/storage",method:"post",params:{method:"add.storage.directory.item"},data:t})}function o(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"desc",e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"storage_id";return Object(a["a"])({url:"/v1/storage",method:"post",params:{method:"get.storage.directory.select"},data:{order_type:t,order_field:e}})}function i(t,e){return Object(a["a"])({url:"/v1/storage",method:"post",params:{method:"set.storage.directory.default"},data:{storage_id:t,is_default:e}})}function s(t){return Object(a["a"])({url:"/v1/storage",method:"post",params:{method:"get.storage.list"},data:t})}function c(t){return Object(a["a"])({url:"/v1/storage",method:"post",params:{method:"get.storage.collection"},data:t})}function l(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Object(a["a"])({url:"/v1/storage",method:"post",params:{method:"get.storage.navi"},data:{storage_id:t,is_layer:e}})}function u(t,e){return Object(a["a"])({url:"/v1/storage",method:"post",params:{method:"rename.storage.item"},data:{storage_id:t,name:e}})}function d(t,e){return Object(a["a"])({url:"/v1/storage",method:"post",params:{method:"set.storage.cover"},data:{storage_id:t,parent_id:e}})}function h(t){return Object(a["a"])({url:"/v1/storage",method:"post",params:{method:"clear.storage.cover"},data:{storage_id:t}})}function g(t,e){return Object(a["a"])({url:"/v1/storage",method:"post",params:{method:"move.storage.list"},data:{storage_id:t,parent_id:e}})}function m(t){return Object(a["a"])({url:"/v1/storage",method:"post",params:{method:"get.storage.thumb.url"},data:t})}function p(t,e){return Object(a["a"])({url:"/v1/storage",method:"post",params:{method:"get.storage.thumb.info"},data:{url:t,source:e}})}function f(t){return Object(a["a"])({url:"/v1/storage",method:"post",params:{method:"del.storage.list"},data:{storage_id:t}})}function b(t){return Object(a["a"])({url:"/v1/storage",method:"post",params:{method:"clear.storage.thumb"},data:{storage_id:t}})}},"283e":function(t,e,r){"use strict";var a=r("e6df"),n=r.n(a);n.a},7830:function(t,e,r){"use strict";r("a4d3"),r("e01a"),r("d28b"),r("d3b7"),r("3ca3"),r("ddb0");var a=r("ca00"),n=r("60bb");e["a"]={data:function(){return{isCheckDirectory:!0}},filters:{getImageThumb:function(t){var e="image/storage/file.png";switch(t["type"]){case 0:e=t["url"]?a["a"].getImageCodeUrl(t["url"],"storage_lists"):"";break;case 2:e=t["cover"]?a["a"].getImageCodeUrl(t["cover"],"storage_lists"):t["is_default"]?"image/storage/default.png":"image/storage/folder.png";break;case 3:e=t["cover"]?a["a"].getImageCodeUrl(t["cover"],"storage_lists"):"image/storage/video.png";break}return e},getFileTypeIocn:function(t){switch(t){case 0:return"el-icon-picture-outline";case 1:return"el-icon-document";case 2:return"el-icon-folder";case 3:return"el-icon-video-camera"}return"el-icon-warning-outline"}},methods:{_getStorageIdList:function(){var t=[],e=!0,r=!1,a=void 0;try{for(var n,o=this.currentTableData[Symbol.iterator]();!(e=(n=o.next()).done);e=!0){var i=n.value;(this.isCheckDirectory||2!==i.type)&&t.push(i.storage_id)}}catch(s){r=!0,a=s}finally{try{e||null==o.return||o.return()}finally{if(r)throw a}}return t},allCheckBox:function(){this.checkList=Object(n["union"])(this.checkList,this._getStorageIdList())},reverseCheckBox:function(){this.checkList=Object(n["xor"])(this.checkList,this._getStorageIdList())},cancelCheckBox:function(){this.checkList=Object(n["difference"])(this.checkList,this._getStorageIdList())}}}},8704:function(t,e,r){"use strict";r.r(e);var a=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("el-dialog",{attrs:{title:"资源选取",visible:t.visible,"append-to-body":!0,"close-on-click-modal":!1,width:"769px"},on:{"update:visible":function(e){t.visible=e}}},[r("el-form",{staticStyle:{"margin-top":"-25px"},attrs:{model:t.form,size:"small"},nativeOn:{submit:function(t){t.preventDefault()}}},[r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:10}},[r("el-form-item",[r("el-button-group",[r("el-tooltip",{attrs:{content:"勾选当前页全部资源",placement:"top"}},[r("el-button",{attrs:{icon:"el-icon-plus"},on:{click:t.allCheckBox}},[t._v("全选")])],1),r("el-tooltip",{attrs:{content:"反向勾选当前页资源",placement:"top"}},[r("el-button",{attrs:{icon:"el-icon-minus"},on:{click:t.reverseCheckBox}},[t._v("反选")])],1),r("el-tooltip",{attrs:{content:"取消当前页勾选",placement:"top"}},[r("el-button",{attrs:{icon:"el-icon-close"},on:{click:t.cancelCheckBox}},[t._v("取消")])],1),r("el-tooltip",{attrs:{content:"清除所有已选中勾选",placement:"top"}},[r("el-button",{attrs:{icon:"el-icon-refresh"},on:{click:function(e){t.checkList=[]}}},[t._v("清除")])],1)],1)],1)],1),r("el-col",{attrs:{span:14}},[r("el-form-item",{attrs:{prop:"name"}},[r("el-input",{attrs:{placeholder:"输入资源名称进行搜索",clearable:!0,size:"small"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleSearch()}},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}},[r("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:t.handleSearch},slot:"append"})],1)],1)],1)],1)],1),r("el-breadcrumb",{staticClass:"breadcrumb cs-mb",attrs:{"separator-class":"el-icon-arrow-right"}},[r("el-breadcrumb-item",[r("a",{staticClass:"cs-cp",on:{click:function(e){return t.switchDirectory(0)}}},[t._v("资源管理")])]),t._l(t.naviData,(function(e){return r("el-breadcrumb-item",{key:e.storage_id},[r("a",{staticClass:"cs-cp",on:{click:function(r){return t.switchDirectory(e.storage_id)}}},[t._v(t._s(e.name))])])}))],2),r("el-checkbox-group",{model:{value:t.checkList,callback:function(e){t.checkList=e},expression:"checkList"}},[r("ul",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"storage-list"},t._l(t.currentTableData,(function(e,a){return r("li",{key:a},[r("dl",[r("dt",[r("div",{staticClass:"picture cs-m-5"},[2!==e.type?r("el-checkbox",{staticClass:"check",attrs:{label:e.storage_id}}):t._e(),r("el-image",{attrs:{fit:"fill",src:t._f("getImageThumb")(e),lazy:""},nativeOn:{click:function(e){return t.handleOpen(a)}}})],1),r("el-tooltip",{attrs:{placement:"top",enterable:!1,"open-delay":300}},[r("div",{attrs:{slot:"content"},slot:"content"},[r("span",[t._v("名称："+t._s(e.name))]),r("br"),r("span",[t._v("日期："+t._s(e.create_time))]),r("br"),0===e.type?r("span",[t._v("尺寸："+t._s(e.pixel["width"]+","+e.pixel["height"]))]):r("span",[t._v("类型："),r("i",{class:t._f("getFileTypeIocn")(e.type)})])]),r("span",{staticClass:"storage-name cs-ml-5"},[t._v(t._s(e.name))])])],1)])])})),0)]),r("page-footer",{staticStyle:{margin:"0",padding:"20px 0 0 0"},attrs:{current:t.page.current,size:t.page.size,total:t.page.total},on:{change:t.handlePaginationChange}}),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("div",{staticStyle:{float:"left","font-size":"13px"}},[t.checkList.length>t.limit&&0!==t.limit?r("span",{staticStyle:{color:"#F56C6C"}},[t._v(" 当前已选 "+t._s(t.checkList.length)+" 个，最多允许选择 "+t._s(t.limit)+" 个资源 ")]):r("span",[t._v("当前已选 "+t._s(t.checkList.length)+" 个资源")])]),r("el-button",{attrs:{size:"small"},on:{click:function(e){t.visible=!1}}},[t._v("取消")]),r("el-button",{attrs:{type:"primary",loading:t.loadingCollection,disabled:t.checkList.length>t.limit&&0!==t.limit,size:"small"},on:{click:t.handleConfirm}},[t._v("确定")])],1)],1)},n=[],o=(r("a4d3"),r("4de4"),r("b0c0"),r("a9e3"),r("e439"),r("dbb4"),r("b64b"),r("d3b7"),r("159b"),r("ade3")),i=r("7830"),s=r("1213");function c(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,a)}return r}function l(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?c(Object(r),!0).forEach((function(e){Object(o["a"])(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}var u={name:"cs-storage",mixins:[i["a"]],components:{PageFooter:function(){return r.e("chunk-2d2102da").then(r.bind(null,"b77f"))}},props:{confirm:{type:Function},limit:{type:Number,required:!1,default:0}},data:function(){return{visible:!1,loading:!0,loadingCollection:!1,naviData:[],checkList:[],currentTableData:[],isCheckDirectory:!1,source:"",storageType:[],form:{name:"",storage_id:0,order_type:"desc",order_field:"storage_id"},page:{current:1,size:48,total:0}}},watch:{"form.storage_id":{handler:function(t){var e=this;Object(s["h"])(t).then((function(t){e.naviData=t.data||[]}))}}},methods:{handleStorageDlg:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.visible=!0,this.storageType=t,this.source=e,this.checkList=[],this.loadingCollection=!1,this.handleSubmit()},switchDirectory:function(t){this.form.name=null,this.form.storage_id=t||0,this.handleSubmit()},handleOpen:function(t){2===this.currentTableData[t].type&&this.switchDirectory(this.currentTableData[t].storage_id)},handlePaginationChange:function(t){var e=this;this.page=t,this.$nextTick((function(){e.handleSubmit()}))},handleSubmit:function(){var t=this;this.loading=!0,Object(s["g"])(l({},this.form,{type:this.storageType,page_no:this.page.current,page_size:this.page.size})).then((function(e){t.currentTableData=e.data.items||[],t.page.total=e.data["total_result"]})).finally((function(){t.loading=!1}))},handleConfirm:function(){var t=this;if(this.checkList.length<=0)return this.$emit("confirm",[],this.source),void(this.visible=!1);this.loadingCollection=!0,Object(s["e"])({storage_id:this.checkList,order_type:this.form.order_type,order_field:this.form.order_field}).then((function(e){t.checkList=[],t.visible=!1,t.$emit("confirm",e.data||[],t.source)})).finally((function(){t.loadingCollection=!1}))},handleSearch:function(){this.page.current=1,this.form.storage_id=0,this.handleSubmit()}}},d=u,h=(r("283e"),r("2877")),g=Object(h["a"])(d,a,n,!1,null,"62e35af4",null);e["default"]=g.exports},e6df:function(t,e,r){}}]);