(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-590f2ff2","chunk-0e5cd068","chunk-38aaf705","chunk-cffee312","chunk-4627a59a"],{1213:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"f",(function(){return o})),a.d(t,"n",(function(){return i})),a.d(t,"g",(function(){return s})),a.d(t,"e",(function(){return l})),a.d(t,"h",(function(){return u})),a.d(t,"l",(function(){return d})),a.d(t,"m",(function(){return c})),a.d(t,"b",(function(){return p})),a.d(t,"k",(function(){return h})),a.d(t,"j",(function(){return f})),a.d(t,"i",(function(){return m})),a.d(t,"d",(function(){return g})),a.d(t,"c",(function(){return v}));var r=a("b775");function n(e){return Object(r["a"])({url:"/v1/storage",method:"post",params:{method:"add.storage.directory.item"},data:e})}function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"desc",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"storage_id";return Object(r["a"])({url:"/v1/storage",method:"post",params:{method:"get.storage.directory.select"},data:{order_type:e,order_field:t}})}function i(e,t){return Object(r["a"])({url:"/v1/storage",method:"post",params:{method:"set.storage.directory.default"},data:{storage_id:e,is_default:t}})}function s(e){return Object(r["a"])({url:"/v1/storage",method:"post",params:{method:"get.storage.list"},data:e})}function l(e){return Object(r["a"])({url:"/v1/storage",method:"post",params:{method:"get.storage.collection"},data:e})}function u(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Object(r["a"])({url:"/v1/storage",method:"post",params:{method:"get.storage.navi"},data:{storage_id:e,is_layer:t}})}function d(e,t){return Object(r["a"])({url:"/v1/storage",method:"post",params:{method:"rename.storage.item"},data:{storage_id:e,name:t}})}function c(e,t){return Object(r["a"])({url:"/v1/storage",method:"post",params:{method:"set.storage.cover"},data:{storage_id:e,parent_id:t}})}function p(e){return Object(r["a"])({url:"/v1/storage",method:"post",params:{method:"clear.storage.cover"},data:{storage_id:e}})}function h(e,t){return Object(r["a"])({url:"/v1/storage",method:"post",params:{method:"move.storage.list"},data:{storage_id:e,parent_id:t}})}function f(e){return Object(r["a"])({url:"/v1/storage",method:"post",params:{method:"get.storage.thumb.url"},data:e})}function m(e,t){return Object(r["a"])({url:"/v1/storage",method:"post",params:{method:"get.storage.thumb.info"},data:{url:e,source:t}})}function g(e){return Object(r["a"])({url:"/v1/storage",method:"post",params:{method:"del.storage.list"},data:{storage_id:e}})}function v(e){return Object(r["a"])({url:"/v1/storage",method:"post",params:{method:"clear.storage.thumb"},data:{storage_id:e}})}},1276:function(e,t,a){"use strict";var r=a("d784"),n=a("44e7"),o=a("825a"),i=a("1d80"),s=a("4840"),l=a("8aa5"),u=a("50c4"),d=a("14c3"),c=a("9263"),p=a("d039"),h=[].push,f=Math.min,m=4294967295,g=!p((function(){return!RegExp(m,"y")}));r("split",2,(function(e,t,a){var r;return r="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(e,a){var r=String(i(this)),o=void 0===a?m:a>>>0;if(0===o)return[];if(void 0===e)return[r];if(!n(e))return t.call(r,e,o);var s,l,u,d=[],p=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.unicode?"u":"")+(e.sticky?"y":""),f=0,g=new RegExp(e.source,p+"g");while(s=c.call(g,r)){if(l=g.lastIndex,l>f&&(d.push(r.slice(f,s.index)),s.length>1&&s.index<r.length&&h.apply(d,s.slice(1)),u=s[0].length,f=l,d.length>=o))break;g.lastIndex===s.index&&g.lastIndex++}return f===r.length?!u&&g.test("")||d.push(""):d.push(r.slice(f)),d.length>o?d.slice(0,o):d}:"0".split(void 0,0).length?function(e,a){return void 0===e&&0===a?[]:t.call(this,e,a)}:t,[function(t,a){var n=i(this),o=void 0==t?void 0:t[e];return void 0!==o?o.call(t,n,a):r.call(String(n),t,a)},function(e,n){var i=a(r,e,this,n,r!==t);if(i.done)return i.value;var c=o(e),p=String(this),h=s(c,RegExp),v=c.unicode,b=(c.ignoreCase?"i":"")+(c.multiline?"m":"")+(c.unicode?"u":"")+(g?"y":"g"),y=new h(g?c:"^(?:"+c.source+")",b),k=void 0===n?m:n>>>0;if(0===k)return[];if(0===p.length)return null===d(y,p)?[p]:[];var _=0,O=0,w=[];while(O<p.length){y.lastIndex=g?O:0;var x,j=d(y,g?p:p.slice(O));if(null===j||(x=f(u(y.lastIndex+(g?0:O)),p.length))===_)O=l(p,O,v);else{if(w.push(p.slice(_,O)),w.length===k)return w;for(var I=1;I<=j.length-1;I++)if(w.push(j[I]),w.length===k)return w;O=_=x}}return w.push(p.slice(_)),w}]}),!g)},"5d78":function(e,t,a){"use strict";var r=a("6493"),n=a.n(r);n.a},6493:function(e,t,a){},8422:function(e,t,a){"use strict";a.r(t);a("b0c0"),a("159b");var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-upload",{attrs:{action:e.uploadUrl,data:e.params,"file-list":e.fileList,"list-type":e.listType,multiple:e.multiple,"show-file-list":e.showFileList,drag:e.drag,accept:e.accept,limit:e.limit,"auto-upload":e.autoUpload,"on-preview":e.handlePreview,"on-remove":e.handleRemove,"before-upload":e.handleBeforeUpload,"on-success":e.handleSuccess,"on-error":e.handleError,"on-exceed":e.handleExceed}},[a("i",{staticClass:"el-icon-plus"}),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v(e._s(e.uploadTip)+"大小不能超过 "+e._s(this.token["file_size"]))])]),null==e.storageId?a("el-cascader",{style:"width: "+e.fileWidth,attrs:{options:e.parentData,props:e.parentProps,filterable:""},model:{value:e.parentId,callback:function(t){e.parentId=t},expression:"parentId"}}):e._e()],1)},n=[],o=(a("a9e3"),a("a4d3"),a("99af"),a("4de4"),a("c975"),a("a434"),a("e439"),a("dbb4"),a("b64b"),a("d3b7"),a("ac1f"),a("25f0"),a("1276"),a("ade3")),i=(a("96cf"),a("1da1")),s=a("a320"),l=a("1213"),u=a("ca00");function d(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function c(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?d(Object(a),!0).forEach((function(t){Object(o["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):d(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var p,h,f={data:function(){return{moduleName:"",replaceId:0,updateToken:!0,token:{},params:{},uploadUrl:"",parentId:-1,parentData:[],parentProps:{value:"storage_id",label:"name",children:"children",checkStrictly:!0,emitPath:!1}}},methods:{getToken:function(){var e=this,t=Math.round(new Date/1e3)+100;if(0!==this.token["expires"]&&t>this.token["expires"]&&(this.updateToken=!0),this.updateToken)return new Promise((function(t){e.params={},e.replaceId?Object(s["c"])(e.replaceId).then((function(a){e.token=a.data||{},e.uploadUrl=e.token["token"]["upload_url"]["upload_url"],e.updateToken=!1,t()})):Object(s["b"])(e.moduleName).then((function(a){e.token=a.data||{},e.uploadUrl=e.token["token"]["upload_url"]["upload_url"],e.updateToken=!1,t()}))}))},handleRemove:function(e,t){if("success"===e.status&&e.response){var a=e.response.data;if(a&&a[0].storage_id){var r=a[0].storage_id;Object(l["d"])(Array.isArray(r)?r:[r])}}this.$emit("upload",t)},handlePreview:function(e){if("success"===e.status){var t=new Image;if(t["src"]=e.url,t["fileSize"]>0||t["width"]>0&&t["height"]>0)return void this.$preview(t["src"])}this.$message.warning("当前模式或资源不支持预览")},handleBeforeUpload:function(){var e=Object(i["a"])(regeneratorRuntime.mark((function e(t){var a,r,n,o,i=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.getToken();case 2:if(this.token&&this.uploadUrl){e.next=5;break}return this.$message.error("上传组件初始化中或配置错误"),e.abrupt("return",!1);case 5:if(a=u["a"].stringToByte(this.token["file_size"]),!(a>0&&t.size>a)){e.next=9;break}return this.$message.error("上传资源大小不能超过 ".concat(this.token["file_size"])),e.abrupt("return",!1);case 9:if(r=t.name.toLowerCase().split(".").splice(-1).toString(),n=this.token["file_ext"]+","+this.token["image_ext"],-1!==n.indexOf(r)){e.next=14;break}return this.$message.error("上传资源的文件后缀不允许上传"),e.abrupt("return",!1);case 14:o=this.token["token"]["upload_url"]["param"],o.forEach((function(e){if("file"!==e.name&&(i.params[e.name]=i.token["token"].hasOwnProperty(e.name)?i.token["token"][e.name]:e.default,!i.replaceId&&("x:filename"===e.name&&(i.params["x:filename"]=t.name),"x:parent_id"===e.name&&(i.params["x:parent_id"]=0,null!==i.storageId?i.params["x:parent_id"]=i.storageId:i.params["x:parent_id"]=i.parentId<=0?0:i.parentId),"key"===e.name))){var a=u["a"].guid();i.params["key"]="".concat(i.token["token"]["dir"]).concat(a,".").concat(r)}})),"careyshop"===this.token["token"]["upload_url"]["module"]&&(this.params["token"]=u["a"].cookies.get("token"),this.params["appkey"]="86757125",this.params["timestamp"]=Math.round(new Date/1e3)+100,this.params["format"]="json",this.params["method"]="add.upload.list",this.params["sign"]=u["a"].getSign(c({},this.params))),this.autoUpload&&(this.loading=!0);case 18:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),handleSuccess:function(e,t,a){if(200===e.status&&e.data)return 200!==e.data[0]["status"]?void this.handleError(e.data[0]["message"],t,a):(this.$emit("upload",a),void this.handleChange(a));this.handleError(e.message,t,a)},handleError:function(e,t,a){this.$message.error("资源：".concat(t.name," 上传失败")),u["a"].log.danger("资源上传失败："+(e||t.response));for(var r=a.length-1;r>=0;r--)if(t===a[r]){a.splice(r,1),this.$emit("upload",a);break}this.handleChange(a)},handleExceed:function(e,t){if(t.length>=this.limit)this.$message.warning("最多只能上传 ".concat(this.limit," 个文件"));else if(e.length+t.length>this.limit){var a=this.limit-t.length;this.$message.warning("上传数量超出限制，最多还能选择 ".concat(a," 个文件"))}},handleChange:function(e){this.autoUpload&&Object.keys(e).every((function(t){return"success"===e[t].status}))&&(this.loading=!1)},getDirectory:function(){var e=this;null!==this.storageId||this.parentData.length>0||Object(l["f"])().then((function(t){e.parentData=u["a"].formatDataToTree(t.data.list,"storage_id"),e.parentData.unshift({storage_id:-1,parent_id:0,name:"根目录"}),e.parentId=t.data.default||-1}))}}},m={name:"cs-upload-comp",mixins:[f],props:{uploadTip:{type:String,required:!1,default:"请选择图片进行上传，"},listType:{type:String,required:!1,default:"picture-card"},multiple:{type:Boolean,required:!1,default:!1},showFileList:{type:Boolean,required:!1,default:!0},drag:{type:Boolean,required:!1,default:!1},accept:{type:String,required:!1,default:"image/*"},limit:{type:Number,required:!1,default:0},autoUpload:{type:Boolean,required:!1,default:!0},fileList:{type:Array,required:!1,default:function(){return[]}},storageId:{type:Number,required:!1,default:null},fileWidth:{type:String,required:!1,default:"30%"}},mounted:function(){this.getToken(),this.getDirectory()}},g=m,v=a("2877"),b=Object(v["a"])(g,r,n,!1,null,null,null),y=b.exports,k=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"upload-control",on:{click:function(t){e.visible=!0}}},[e._t("control"),a("el-dialog",{attrs:{width:"400px",visible:e.visible,"append-to-body":!0,"close-on-click-modal":!1},on:{"update:visible":function(t){e.visible=t},open:e.handleOpen,close:e.handleClose}},[a("el-upload",{ref:"upload",attrs:{"list-type":"text",action:e.uploadUrl,data:e.params,multiple:e.multiple,"show-file-list":e.showFileList,drag:e.drag,accept:e.accept,limit:e.limit,"auto-upload":e.autoUpload,"on-preview":e.handlePreview,"on-remove":e.handleRemove,"before-upload":e.handleBeforeUpload,"on-success":e.handleSuccess,"on-error":e.handleError,"on-exceed":e.handleExceed}},[a("i",{staticClass:"el-icon-upload"}),a("div",{staticClass:"el-upload__text"},[e._v("将资源拖到此处，或"),a("em",[e._v("点击上传")])]),a("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v(e._s(e.uploadTip)+"大小不能超过 "+e._s(this.token["file_size"]))])]),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("div",{staticClass:"cs-fl"},[null==e.storageId?a("el-cascader",{attrs:{options:e.parentData,props:e.parentProps,size:"small",filterable:""},model:{value:e.parentId,callback:function(t){e.parentId=t},expression:"parentId"}}):e._e()],1),a("el-button",{attrs:{size:"small"},on:{click:e.handleClose}},[e._v("取消")]),a("el-button",{attrs:{loading:e.loading,type:"primary",size:"small"},on:{click:e.handleConfirm}},[e._v("确定")])],1)],1)],2)},_=[],O={name:"cs-upload-slot",mixins:[f],props:{uploadTip:{type:String,required:!1,default:"请选择资源进行(支持拖拽)上传，"},multiple:{type:Boolean,required:!1,default:!0},showFileList:{type:Boolean,required:!1,default:!0},drag:{type:Boolean,required:!1,default:!0},accept:{type:String,required:!1,default:"*/*"},limit:{type:Number,required:!1,default:0},autoUpload:{type:Boolean,required:!1,default:!0},storageId:{type:Number,required:!1,default:null}},data:function(){return{visible:!1,loading:!1}},methods:{handleOpen:function(){this.getToken(),this.getDirectory()},handleClose:function(){this.replaceId>0&&(this.updateToken=!0),this.replaceId=0,this.visible=!1,this.loading=!1,this.$refs.upload&&this.$refs.upload.clearFiles()},handleConfirm:function(){this.$emit("confirm"),this.handleClose()}}},w=O,x=(a("5d78"),Object(v["a"])(w,k,_,!1,null,"0618f42e",null)),j=x.exports,I={name:"cs-upload",props:{value:{type:Array,required:!1,default:function(){return[]}},confirm:{type:Function},type:{type:String,required:!1,default:"comp"}},data:function(){return{fileList:[],source:""}},computed:{component:function(){return"comp"===this.type?y:"slot"===this.type?j:"div"}},render:function(e){var t=this,a=[e("div",this.$slots.default)];return this.$slots.control&&a.push(e("div",{slot:"control"},[this.$slots.control])),e("div",{},[e(this.component,{ref:"upload",props:this.$attrs,on:{upload:function(e){"comp"===t.type&&t.$emit("input",t.getUploadData(e)),"slot"===t.type&&(t.fileList=e)},confirm:function(){"slot"===t.type&&(t.$emit("confirm",t.fileList,t.source),t.fileList=[])}}},a)])},methods:{getUploadData:function(e){var t=[];return e.forEach((function(e){e.response?t.push({name:e.response.data[0]["name"],source:e.response.data[0]["url"],url:"//"+e.response.data[0]["url"]}):t.push({name:e.name,source:e.source,url:e.url})})),t},handleUploadDlg:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";"slot"===this.type&&(this.$refs.upload.visible=!0,this.source=e)},setReplaceId:function(e){this.$refs.upload.replaceId=e,this.$refs.upload.updateToken=!0},setModuleName:function(e){this.$refs.upload.moduleName=e,this.$refs.upload.updateToken=!0}}},$=I,q=Object(v["a"])($,p,h,!1,null,null,null);t["default"]=q.exports},a320:function(e,t,a){"use strict";a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return o})),a.d(t,"c",(function(){return i}));var r=a("b775");function n(){return Object(r["a"])({url:"/v1/upload",method:"post",params:{method:"get.upload.module"}})}function o(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"web";return Object(r["a"])({url:"/v1/upload",method:"post",params:{method:"get.upload.token"},data:{module:e,type:t}})}function i(e){return Object(r["a"])({url:"/v1/upload",method:"post",params:{method:"replace.upload.item"},data:{storage_id:e}})}}}]);